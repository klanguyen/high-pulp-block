(()=>{"use strict";var e={352:(e,t,r)=>{var n=r(34);t.C=n.createRoot,n.hydrateRoot},34:e=>{e.exports=window.ReactDOM}},t={};function r(n){var a=t[n];if(void 0!==a)return a.exports;var s=t[n]={exports:{}};return e[n](s,s.exports,r),s.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{const e=window.React;var t=r.n(e),n=r(352);function a({rating:t,setRating:r,readonly:n}){const[a,s]=(0,e.useState)(t||0);return(0,e.createElement)("div",{className:n?"readonly stars":"stars"},[1,2,3,4,5].map((n=>(0,e.createElement)("span",{className:n<=a?"star on":"star off",onClick:()=>r(n),onMouseEnter:()=>s(n),onMouseLeave:()=>s(t)},"â˜…"))))}class s extends t().Component{state={title:"",review:"",rating:0};addReview(e){e.preventDefault();const t={title:this.state.title,content:this.state.review,acf:{review_rating:parseInt(this.state.rating)||0},status:"publish"};this.props?.addReview?.(t),this.setState({title:"",review:"",rating:0})}render(){return(0,e.createElement)("form",{className:"new-review-form",onSubmit:e=>this.addReview(e)},(0,e.createElement)("div",null,(0,e.createElement)("label",null,"Title:",(0,e.createElement)("input",{type:"text",value:this.state.title,onInput:e=>this.setState({title:e.target.value})}))),(0,e.createElement)("div",null,(0,e.createElement)("label",null,"Overall Rating:",(0,e.createElement)(a,{rating:this.state.rating,setRating:e=>this.setState({rating:e})}))),(0,e.createElement)("div",null,(0,e.createElement)("label",null,"Review:",(0,e.createElement)("textarea",{value:this.state.review,onInput:e=>this.setState({review:e.target.value})}))),(0,e.createElement)("button",{type:"submit"},"Add Review"))}}class i extends t().Component{render(){let{title:t,review:r,rating:n}=this.props;return(0,e.createElement)("div",{className:"review-card"},(0,e.createElement)("div",{className:"review-title",dangerouslySetInnerHTML:{__html:t}}),(0,e.createElement)(a,{rating:n,readonly:!0}),(0,e.createElement)("div",{className:"review-content",dangerouslySetInnerHTML:{__html:r}}))}}class l extends t().Component{render(){return(0,e.createElement)("div",{className:"review-list"},this.props.reviews.map((t=>(0,e.createElement)(i,{title:t.attributes.title.rendered,review:t.attributes.content.rendered,rating:t.attributes.acf.review_rating,key:t.attributes.id}))))}}class o extends t().Component{state={reviews:[],loggedIn:null};addReview(e){new wp.api.models.Review(e).save().done((e=>{console.log("Successfully added review!",e),this.getReviews()})).fail((e=>{console.error("Failed adding review!",e)}))}getReviews(){const e=new wp.api.collections.Review;e.fetch().done((t=>{console.log("Successfully fetched!",t,e),this.setState({reviews:e.models})})).fail((e=>{console.error("Failed fetching!",e)}))}getLoggedInUser(){(new wp.api.models.UsersMe).fetch().done((e=>{this.setState({loggedIn:!0})})).fail((e=>{this.setState({loggedIn:!1})}))}componentDidMount(){this.getReviews(),this.getLoggedInUser()}render(){return(0,e.createElement)("div",null,(0,e.createElement)("h3",null,"Latest Reviews"),(0,e.createElement)(l,{reviews:this.state.reviews}),(0,e.createElement)("hr",null),(0,e.createElement)("h3",null,"Submit a Review"),!0===this.state.loggedIn&&(0,e.createElement)(s,{addReview:e=>this.addReview(e)}),!1===this.state.loggedIn&&(0,e.createElement)("div",{className:"error-msg"},"You must be logged in to submit a review"))}}document.querySelectorAll(".wp-block-kn-submit-review").forEach((t=>{(0,n.C)(t).render((0,e.createElement)(o,null))}))})()})();